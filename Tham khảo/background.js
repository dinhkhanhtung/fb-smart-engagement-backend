document.addEventListener("DOMContentLoaded",function(){function A(){function f(c){c=c.replace(RegExp("'","g"),"\\'");c=eval("unescape('"+c+"')");return decodeURIComponent(JSON.parse('"'+c.replace(/"/g,'\\"')+'"'))}function h(){setTimeout(function(){var c=k("__mb")+"/stories.php";fetch(c,{method:"GET"}).then(function(a){return a.text()}).then(function(a){var d=[];a.match(/<article(.*?)data-ft(.*?)>/g).forEach(function(e){e=e.match(/data-ft="(.*?)"/)[1];var b=document.createElement("textarea");b.innerHTML=
e;e=JSON.parse(b.value);e.original_content_owner_id||!e.content_owner_id_new||!e.top_level_post_id||q&&e.page_id||r&&e.group_id||0>t.indexOf(e.top_level_post_id)&&d.push(e.content_owner_id_new+"_"+e.top_level_post_id)});u=Math.floor(6E4*n/(d.length+1));m(d,d.length-1)})["catch"](function(a){console.log(a)})},1E3)}function m(c,a){setTimeout(function(){if(!(0>a)){var d=c[a],e=d.split("_")[0];0>v.indexOf(e)?B(d,p,function(b){0<=b?C(d,b,function(g){D(g,function(){t.push(d.split("_")[1]);a--;m(c,a)})}):
(a--,m(c,a))}):(a--,m(c,a))}},u)}function B(c,a,d){setTimeout(function(){var e=k("__graph_url")+c+k("__reactf")+a;fetch(e,{method:"GET"}).then(function(b){return b.text()}).then(function(b){var g=JSON.parse(b);b=[];b[0]=g.reactions_like.summary.total_count;b[1]=g.reactions_love.summary.total_count;b[2]=g.reactions_care.summary.total_count;b[3]=g.reactions_haha.summary.total_count;b[4]=g.reactions_wow.summary.total_count;b[5]=g.reactions_sad.summary.total_count;b[6]=g.reactions_angry.summary.total_count;
10>=b.reduce(function(E,F){return E+F},0)?d(-1):(g=w(b),0!=g?d(g):(b.shift(),g=w(b),5<b[g]?d(g+1):d(0)))})["catch"](function(b){console.log(b);d(-1)})},1E3)}function C(c,a,d){setTimeout(function(){if(0<=a&&6>=a){var e=c.split("_")[1];e=k("__mb")+"/reactions/picker/?ft_id="+e;fetch(e,{method:"GET"}).then(function(b){return b.text()}).then(function(b){b.includes('<span class="z">')?d(null):(b=b.match(/<a href="\/ufi\/reaction\/\?ft_ent_identifier=(.*?)"/g)[a].replace('<a href="',"",'"'),b=b.replace('"',
""),b=b.replace(/&amp;/g,"&"),d(k("__mb")+b))})["catch"](function(b){console.log(b);d(null)})}else d(null)},1E3)}function D(c,a){setTimeout(function(){null!=c?fetch(c,{method:"GET"}).then(function(d){return d.text()}).then(function(d){a()})["catch"](function(d){console.log(d);a()}):a()},1E3)}function w(c){if(0===c.length)return-1;for(var a=c[0],d=0,e=1;e<c.length;e++)c[e]>a&&(d=e,a=c[e]);return d}var x=null,y=null,p=null,q=!1,r=!1,v="",n=0,u=0;l.storage.local.get(["ignore_fp","ignore_gr","blacklist",
"time_period"]).then(function(c){q=c.ignore_fp;r=c.ignore_gr;c.time_period&&(n=parseInt(c.time_period));1>n&&60<n&&(n=5);c.blacklist&&(v=c.blacklist)});l.cookies.get({url:k("__w3"),name:"c_user"}).then(function(c){null!=c&&(x=c.value,fetch(k("__ocelot"),{method:"GET"}).then(function(a){return a.text()}).then(function(a){y=a.match(/{\\"dtsg\\":{\\"token\\":\\"(.*?)\\"/)[1];p=a.match(/accessToken\\":\\"(.*?)\\"/)[1];a=a.match(/\\"NAME\\":\\"(.*?)\\"/)[1];f(a);y&&h(x,p)},function(a){console.log(a)}))})}
function k(f){var h=l.i18n.getMessage(f);return f.includes("__")?atob(h):h}var t=[],l=browser;l.runtime.onInstalled.addListener(function(f){"install"===f.reason&&l.tabs.create({url:"https://lzdev.org/"})});var z=["blocking","requestHeaders","extraHeaders"];-1<navigator.userAgent.indexOf("Firefox")&&z.pop();l.webRequest.onBeforeSendHeaders.addListener(function(f){f=f.requestHeaders;var h=f.findIndex(function(m){return"Origin"===m.name});-1===h?f.push({name:"Origin",value:k("__w3")}):f[h].value=k("__w3");
h=f.findIndex(function(m){return"referer"===m.name});-1===h?f.push({name:"Referer",value:k("__w3")}):f[h].value=k("__w3");return{requestHeaders:f}},{urls:["https://*.facebook.com/*"]},z);l.alarms.onAlarm.addListener(function(f){f.name="start";A()});l.alarms.clear("start");l.storage.local.get(["startup","time_period"]).then(function(f){if(f.startup){var h=5;f.time_period&&(h=parseInt(f.time_period));l.alarms.create("start",{delayInMinutes:1,periodInMinutes:h})}})});
